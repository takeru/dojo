# トピック: `<<<1, n>>>` の意味

## メタ情報

- **ID**: kernel-launch-syntax
- **難易度**: 初級
- **所要時間**: 3-5分（対話形式）/ 1-2分（読み物）
- **カテゴリ**: 言語機能

## 前提知識

- Stage 1完了

## このトピックで学べること

- カーネル起動構文の意味
- グリッドサイズとブロックサイズ
- スレッド数の計算方法

## 関連ステージ

- Stage 1: 環境構築と Hello GPU

## 要点（ドキュメント形式用）

`<<<グリッドサイズ, ブロックサイズ>>>` という構文で、何個のスレッドを起動するか指定します。

### 基本構文

```cuda
kernel<<<gridSize, blockSize>>>(args...);
```

### 例

```cuda
initArray<<<1, 10>>>(d_arr, n);
```

- 第1引数（1）: ブロック数（グリッドサイズ）
- 第2引数（10）: ブロックあたりのスレッド数

合計スレッド数 = 1 × 10 = 10スレッド

### より多くのスレッドを起動

```cuda
// 1000スレッドを起動（4ブロック × 256スレッド）
int blockSize = 256;
int gridSize = (1000 + blockSize - 1) / blockSize;  // = 4
kernel<<<gridSize, blockSize>>>(d_arr, n);
```

### オプション引数

```cuda
kernel<<<grid, block, sharedMemBytes, stream>>>(args...);
```
- 第3引数: 動的シェアードメモリサイズ（デフォルト: 0）
- 第4引数: CUDAストリーム（デフォルト: 0）

## 対話形式の教え方ガイド（先生用）

### 導入

「カッコが3つもあって不思議だよね。これはCUDAが追加した特別な構文なんだ」

### 説明の流れ

1. **構文の意味を説明**
   - 第1引数 = ブロック数
   - 第2引数 = ブロックあたりのスレッド数

2. **計算例**
   ```cuda
   <<<2, 5>>>  // 2 × 5 = 10スレッド
   <<<4, 256>>> // 4 × 256 = 1024スレッド
   ```

3. **後のステージへの布石**
   「大きなデータを処理するときは、複数ブロックを使うよ」

## クリア条件（オプション）

- [ ] `<<<grid, block>>>` の各引数の意味を説明できる
- [ ] 合計スレッド数を計算できる

## 補足情報

### 制限

- ブロックサイズは最大1024スレッド
- グリッドサイズは非常に大きく設定可能

### 参考リンク

- [CUDA C++ Programming Guide - Execution Configuration](https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#execution-configuration)
