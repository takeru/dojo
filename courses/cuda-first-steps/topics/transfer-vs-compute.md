# トピック: 転送時間 vs 計算時間

## メタ情報

- **ID**: transfer-vs-compute
- **難易度**: 初級
- **所要時間**: 3-5分（対話形式）/ 1-2分（読み物）
- **カテゴリ**: パフォーマンス

## 前提知識

- Stage 3完了

## このトピックで学べること

- 転送と計算の時間比較
- ボトルネックの見つけ方
- パフォーマンス改善の方向性

## 関連ステージ

- Stage 3: 速度を測ってみる

## 要点（ドキュメント形式用）

GPU版で一番時間がかかっているのは、実は**データ転送**です。

### 時間の内訳例

```
cudaMalloc:         0.0001秒
CPU→GPU転送:       0.0010秒 ← 遅い
カーネル実行:       0.0001秒
GPU→CPU転送:       0.0010秒 ← 遅い
cudaFree:          0.0001秒
```

転送が全体の80%以上を占めることも珍しくありません。

### なぜ転送が遅いのか

```
CPU ←--PCIeバス--→ GPU
      (ボトルネック)
```

- GPU内部メモリ: 数百GB/秒〜1TB/秒
- PCIeバス: 約12GB/秒（3.0 x16）

### 改善の方向性

1. 転送回数を減らす
2. 転送と計算を並行実行
3. Pinned Memoryで転送高速化

## 対話形式の教え方ガイド（先生用）

### 導入

「GPU版で一番時間がかかっているのはどこ？実は計算じゃないんだ」

### 説明の流れ

1. **時間内訳を見せる**
2. **転送がボトルネックと認識**
3. **次のステージへの布石**
   「次は転送コストを詳しく学ぶよ」

## クリア条件（オプション）

- [ ] 転送が計算より遅いことを理解している
- [ ] ボトルネックの概念を理解している

## 補足情報

### 参考リンク

- [CUDA C++ Best Practices Guide - Data Transfer](https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/)
