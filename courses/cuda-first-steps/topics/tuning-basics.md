# トピック: なんかまだ遅い…そんな時のチューニング入門

## メタ情報

- **ID**: tuning-basics
- **難易度**: 中級
- **所要時間**: 10-15分
- **カテゴリ**: 最適化

## 前提知識

- Stage 7完了

## このトピックで学べること

- パフォーマンスチューニングの基本
- よくあるボトルネック
- 改善の優先順位

## 関連ステージ

- Stage 7: 行列積

## 要点（ドキュメント形式用）

### チューニングの手順

1. **測定**: Nsightでプロファイル
2. **ボトルネック特定**: 転送？計算？
3. **改善**: 効果の大きいものから
4. **再測定**: 改善を確認

### よくあるボトルネックと対策

| ボトルネック | 対策 |
|--------------|------|
| メモリ転送が遅い | Pinned Memory, Streams, 転送削減 |
| カーネルが遅い | ブロックサイズ調整, シェアードメモリ |
| Warp分岐 | 分岐削減, データ配置変更 |
| メモリアクセス | Coalesced Access |

### ブロックサイズの調整

```cuda
// 色々試してみる
dim3 blockSize(16, 16);  // 256スレッド
dim3 blockSize(8, 8);    // 64スレッド
dim3 blockSize(32, 32);  // 1024スレッド
```

ベストな値はGPUとカーネルによって異なるので、実測が重要！

### Occupancy（GPU利用率）

- SMあたり何ワープ実行できているか
- 低いと性能が出ない
- Nsight Computeで確認可能

## 対話形式の教え方ガイド（先生用）

### 導入

「プログラムは動いたけど、もっと速くしたい。そんな時のアプローチを教えるよ」

### 実践課題

1. Nsightでプロファイル
2. ブロックサイズを変えて速度測定
3. 一番速い設定を見つける

## クリア条件

- [ ] ボトルネックを特定できる
- [ ] ブロックサイズを調整できる

## 補足情報

### 参考リンク

- [CUDA C++ Best Practices Guide](https://docs.nvidia.com/cuda/cuda-c-best-practices-guide/)
